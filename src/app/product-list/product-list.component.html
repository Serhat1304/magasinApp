<div class="product-list">
  <h2 class="titre-tableau">Produits du magasin "<strong>{{ nameStore }}</strong>"</h2>

  <button
    pButton
    type="button"
    label="Ajouter un produit"
    icon="pi pi-plus"
    (click)="openCreateProductDialog()"
  ></button>

  <div class="card">
    <div class="container-tableau min-h-[200px]">
      <p-table
        #dt2
        [value]="products"
        dataKey="id"
        [rows]="10"
        [rowsPerPageOptions]="[10, 25, 50]"
        [paginator]="true"
        [globalFilterFields]="['name', 'category', 'price', 'quantity']"
        [tableStyle]="{ 'min-width': '75rem' }"
      >
        <!-- En-tête avec filtres -->
        <ng-template pTemplate="header">
          <tr>
            <th style="width:30%">Nom</th>
            <th style="width:30%">Catégorie</th>
            <th style="width:15%">Prix (€)</th>
            <th style="width:15%">Quantité</th>
            <th style="width:10%">Actions</th>
          </tr>
          <tr>
            <th>
              <p-columnFilter
                type="text"
                field="name"
                placeholder="Filtrer par nom"
                ariaLabel="Filtrer le nom"
              ></p-columnFilter>
            </th>
            <th>
              <p-dropdown
                [options]="categories"
                optionLabel="name"
                placeholder="Filtrer par catégorie"
                [(ngModel)]="selectedCategoryId"
                (onChange)="dt2.filter(selectedCategoryId, 'categoryId', 'equals')"
                class="z-1000"
              ></p-dropdown>
            </th>
            <th>
              <p-columnFilter
                type="numeric"
                matchMode="lte"
                field="price"
                placeholder="Prix maximum"
                ariaLabel="Filtrer par prix"
              ></p-columnFilter>
            </th>
            <th>
              <p-columnFilter
                type="numeric"
                matchMode="lte"
                field="quantity"
                placeholder="Quantité maximum"
                ariaLabel="Filtrer par quantité"
              ></p-columnFilter>
            </th>
            <th>
              <!-- Pas de filtre pour les actions -->
            </th>
          </tr>
        </ng-template>

        <!-- Corps -->
        <ng-template pTemplate="body" let-product>
          <tr>
            <td>{{ product.name }}</td>
            <td>{{ getCategoryName(product.categoryId) }}</td>
            <td [appEuroCurrency]=" product.price " ></td>
            <td>{{ product.quantity }}</td>
            <td>
              <div class="action-buttons">
                <button
                  pButton
                  type="button"
                  icon="pi pi-pencil"
                  class="p-button-rounded p-button-text p-button-info button-with-border"
                  (click)="editProduct(product)"
                  title="Modifier"
                ></button>
              </div>
            </td>
          </tr>
        </ng-template>

        <!-- Message pour tableau vide -->
        <ng-template pTemplate="emptymessage">
          <tr class="min-h-[200px]">
            <td colspan="5">Aucun produit trouvé.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
